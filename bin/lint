#!/usr/bin/env bash

root=$(npm explore lint-my-app -- pwd >/dev/null 2>&1 || echo .)
stylelintConfig=$(node $root/addConfig stylelint)

code=0

pkg-ok
code=$(($code + $?))

eslint --ignore-path .gitignore --color --ignore-pattern '!.*.js' --report-unused-disable-directives $(node $root/addConfig eslint) .
code=$(($code + $?))

stylelint --ignore-path .gitignore --color $stylelintConfig "**/*.css"
code=$(($code + $?))
stylelint --ignore-path .gitignore --color $stylelintConfig --report-needless-disables "**/*.css"
code=$(($code + $?))

stylelint --syntax=scss --ignore-path .gitignore --color $stylelintConfig "**/*.scss"
code=$(($code + $?))
stylelint --syntax=scss --ignore-path .gitignore --color $stylelintConfig --report-needless-disables "**/*.scss"
code=$(($code + $?))

git ls-files | grep "\.json$" | grep -v package | xargs -I{} jsonlint --quiet "$(pwd)/{}"
code=$(($code + $?))

exit $code
